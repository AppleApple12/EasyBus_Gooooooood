Index: app/src/main/java/com/example/easybus/qrcode_page.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easybus;\r\n\r\nimport androidx.appcompat.app.ActionBar;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.graphics.Bitmap;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.android.volley.Request;\r\nimport com.android.volley.RequestQueue;\r\nimport com.android.volley.Response;\r\nimport com.android.volley.VolleyError;\r\nimport com.android.volley.toolbox.JsonObjectRequest;\r\nimport com.android.volley.toolbox.Volley;\r\nimport com.google.zxing.BarcodeFormat;\r\nimport com.google.zxing.MultiFormatWriter;\r\nimport com.google.zxing.WriterException;\r\nimport com.google.zxing.common.BitMatrix;\r\nimport com.journeyapps.barcodescanner.BarcodeEncoder;\r\n\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\npublic class qrcode_page extends AppCompatActivity {\r\n    String email,getmail,fullname,getfullname;\r\n    ImageView qrcode,backBtn,qrscan;\r\n    TextView back;\r\n    String identity;\r\n    RequestQueue requestQueue;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_qrcode_page);\r\n\r\n        //隱藏title bar\r\n        ActionBar actionBar = getSupportActionBar();\r\n        actionBar.hide();\r\n        qrscan = findViewById(R.id.qrscan_btn);\r\n        qrcode=findViewById(R.id.qrimage);\r\n        back=findViewById(R.id.back);\r\n        requestQueue = Volley.newRequestQueue(this);\r\n        getmail = mail();\r\n        getfullname=fullname();\r\n        readUser();\r\n        //前往掃描\r\n        qrscan.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(qrcode_page.this,qrscanner.class);\r\n                intent.putExtra(\"email\",getmail);\r\n                startActivity(intent);\r\n                finish();\r\n            }\r\n        });\r\n        //返回健(基本資料)\r\n        back.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                turnpage(identity);\r\n                /*Intent intent = new Intent(qrcode_page.this,Page8Activity.class);\r\n                intent.putExtra(\"email\",getmail);\r\n                startActivity(intent);\r\n                finish();*/\r\n            }\r\n        });\r\n        MultiFormatWriter writer = new MultiFormatWriter();\r\n        try{\r\n            BitMatrix martix = writer.encode(getmail, BarcodeFormat.QR_CODE,350,350);\r\n            BarcodeEncoder encoder = new BarcodeEncoder();\r\n            Bitmap bitmap = encoder.createBitmap(martix);\r\n            qrcode.setImageBitmap(bitmap);\r\n        }catch (WriterException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n    }\r\n    public String mail(){\r\n        Bundle extras = getIntent().getExtras();\r\n        if (extras!=null){\r\n            email=extras.getString(\"email\");\r\n        }\r\n        return email;\r\n    }\r\n    public String fullname(){\r\n        Bundle extras = getIntent().getExtras();\r\n        if (extras!=null){\r\n            fullname=extras.getString(\"fullname\");\r\n        }\r\n        return fullname;\r\n    }\r\n    public void readUser(){\r\n        String URL =Urls.url1+\"/LoginRegister/fetch.php?email=\"+email;\r\n        JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(\r\n                Request.Method.GET,\r\n                URL,\r\n                null,\r\n                new Response.Listener<JSONObject>() {\r\n\r\n                    @Override\r\n                    public void onResponse(JSONObject response) {\r\n                        try {\r\n                            identity = response.getString(\"identity\");\r\n                        } catch (JSONException e) {\r\n                            e.printStackTrace();\r\n                            Toast.makeText(qrcode_page.this, e.toString(), Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    }\r\n                },\r\n                new Response.ErrorListener() {\r\n                    @Override\r\n                    public void onErrorResponse(VolleyError error) {\r\n                        Toast.makeText(qrcode_page.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }\r\n        );\r\n        requestQueue.add(jsonObjectRequest);\r\n    }\r\n\r\n    private void turnpage(String identity) {\r\n\r\n        if(\"requester\".equalsIgnoreCase(identity)) {\r\n            Intent it4 = new Intent(qrcode_page.this,Page8Activity.class);\r\n            it4.putExtra(\"email\", email);\r\n            startActivity(it4);\r\n            finish();\r\n        }else if(\"caregiver\".equalsIgnoreCase(identity)){\r\n            Intent it = new Intent(qrcode_page.this,Page8Activity_caregiver.class);\r\n            it.putExtra(\"email\", email);\r\n            startActivity(it);\r\n            finish();\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/easybus/qrcode_page.java	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/java/com/example/easybus/qrcode_page.java	(date 1632907447008)
@@ -8,6 +8,7 @@
 import android.graphics.Bitmap;
 import android.os.Bundle;
 import android.view.View;
+import android.widget.ImageButton;
 import android.widget.ImageView;
 import android.widget.TextView;
 import android.widget.Toast;
@@ -30,7 +31,8 @@
 public class qrcode_page extends AppCompatActivity {
     String email,getmail,fullname,getfullname;
     ImageView qrcode,backBtn,qrscan;
-    TextView back;
+    //TextView back;
+    ImageButton back;
     String identity;
     RequestQueue requestQueue;
     @Override
@@ -41,19 +43,22 @@
         //隱藏title bar
         ActionBar actionBar = getSupportActionBar();
         actionBar.hide();
+        //抓email
+        SharedPreferences email = getSharedPreferences("email",MODE_PRIVATE);
+        getmail=email.getString("Email","");
         qrscan = findViewById(R.id.qrscan_btn);
         qrcode=findViewById(R.id.qrimage);
         back=findViewById(R.id.back);
         requestQueue = Volley.newRequestQueue(this);
-        getmail = mail();
-        getfullname=fullname();
+        //getmail = mail();
+        //getfullname=fullname();
         readUser();
         //前往掃描
         qrscan.setOnClickListener(new View.OnClickListener() {
             @Override
             public void onClick(View v) {
                 Intent intent = new Intent(qrcode_page.this,qrscanner.class);
-                intent.putExtra("email",getmail);
+                //intent.putExtra("email",getmail);
                 startActivity(intent);
                 finish();
             }
@@ -80,7 +85,7 @@
         }
 
     }
-    public String mail(){
+    /*public String mail(){
         Bundle extras = getIntent().getExtras();
         if (extras!=null){
             email=extras.getString("email");
@@ -93,9 +98,9 @@
             fullname=extras.getString("fullname");
         }
         return fullname;
-    }
+    }*/
     public void readUser(){
-        String URL =Urls.url1+"/LoginRegister/fetch.php?email="+email;
+        String URL =Urls.url1+"/LoginRegister/fetch.php?email="+getmail;
         JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(
                 Request.Method.GET,
                 URL,
@@ -126,12 +131,12 @@
 
         if("requester".equalsIgnoreCase(identity)) {
             Intent it4 = new Intent(qrcode_page.this,Page8Activity.class);
-            it4.putExtra("email", email);
+            it4.putExtra("email", getmail);
             startActivity(it4);
             finish();
         }else if("caregiver".equalsIgnoreCase(identity)){
             Intent it = new Intent(qrcode_page.this,Page8Activity_caregiver.class);
-            it.putExtra("email", email);
+            it.putExtra("email", getmail);
             startActivity(it);
             finish();
         }
Index: app/src/main/java/com/example/easybus/friend.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easybus;\r\n\r\npublic class friend {\r\n    String F_name,F_phone;\r\n\r\n    public String getF_phone() {\r\n        return F_phone;\r\n    }\r\n\r\n    public void setF_phone(String f_phone) {\r\n        F_phone = f_phone;\r\n    }\r\n\r\n    public String getF_name() {\r\n        return F_name;\r\n    }\r\n\r\n    public void setF_name(String f_name) {\r\n        F_name = f_name;\r\n    }\r\n\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/easybus/friend.java	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/java/com/example/easybus/friend.java	(date 1632907582674)
@@ -1,7 +1,9 @@
 package com.example.easybus;
 
 public class friend {
-    String F_name,F_phone;
+    String F_name,F_phone,F_image;
+    private String imageUrl;
+    private String femail;
 
     public String getF_phone() {
         return F_phone;
@@ -19,5 +21,21 @@
         F_name = f_name;
     }
 
+    public String getF_image() {
+        return F_image;
+    }
+
+    public void setF_image(String f_image) {
+        F_image = f_image;
+    }
+    public String getFemail(){return femail;}
+    public void setFemail(String femail){this.femail=femail;}
+
+    public String getImageUrl(){
+        return imageUrl;
+    }
+    public  void  setImageUrl(String imageUrl){
+        this.imageUrl = imageUrl;
+    }
 
 }
\ No newline at end of file
Index: app/src/main/java/com/example/easybus/my_contact.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easybus;\r\n\r\nimport androidx.appcompat.app.ActionBar;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.app.Dialog;\r\nimport android.content.Intent;\r\nimport android.graphics.Color;\r\nimport android.graphics.drawable.ColorDrawable;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.android.volley.Request;\r\nimport com.android.volley.RequestQueue;\r\nimport com.android.volley.Response;\r\nimport com.android.volley.VolleyError;\r\nimport com.android.volley.toolbox.JsonArrayRequest;\r\nimport com.android.volley.toolbox.JsonObjectRequest;\r\nimport com.android.volley.toolbox.StringRequest;\r\nimport com.android.volley.toolbox.Volley;\r\nimport com.squareup.picasso.Callback;\r\nimport com.squareup.picasso.Picasso;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\n\r\npublic class my_contact extends AppCompatActivity {\r\n    String email,getmail,img;\r\n    TextView mEnteredName;\r\n    ImageView backBtn;\r\n    RequestQueue requestQueue;\r\n    RecyclerView mrecyclerView;\r\n    friendAdapter friendAdapter;\r\n    List<friend> friendList;\r\n    Dialog dialog;\r\n    Button clickme;\r\n    CircleImageView mPforfilepic;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_my_contact);\r\n        //隱藏title bar///\r\n        ActionBar actionBar = getSupportActionBar();\r\n        actionBar.hide();\r\n\r\n        backBtn=findViewById(R.id.backicon);\r\n        mEnteredName = findViewById(R.id.EnteredName);\r\n        dialog = new Dialog(my_contact.this);\r\n        mPforfilepic = findViewById(R.id.profilepic);\r\n        dialog.setContentView(R.layout.nofriend_dialog);\r\n        //刪除dialog方方的背景\r\n        dialog.getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT));\r\n        clickme=dialog.findViewById(R.id.button10);\r\n\r\n        LoadAllfriend();\r\n        LinearLayoutManager linearLayoutManager = new LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false);\r\n        mrecyclerView=findViewById(R.id.recyclerview);\r\n        mrecyclerView.setHasFixedSize(true);\r\n        // LinearLayoutManager llm = new LinearLayoutManager(this);\r\n        //llm.setOrientation(LinearLayoutManager.VERTICAL);\r\n        //mrecyclerView.setLayoutManager(new LinearLayoutManager(this));\r\n        mrecyclerView.setLayoutManager(linearLayoutManager);\r\n\r\n        friendList = new ArrayList<>();\r\n        //friendAdapter = new friendAdapter(my_contact.this,friendList);\r\n        //mrecyclerView.setAdapter(friendAdapter);\r\n        requestQueue = Volley.newRequestQueue(this);\r\n        getmail=mail();\r\n        readUser();\r\n        fetchimage();\r\n        ImageRetriveWithPicasso();\r\n        //返回我的資料\r\n        backBtn.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(my_contact.this,Page8Activity.class);\r\n                intent.putExtra(\"email\",getmail);\r\n                startActivity(intent);\r\n                finish();\r\n            }\r\n        });\r\n\r\n        String URL =Urls.url1+\"/LoginRegister/my_contact.php?email=\"+getmail;\r\n        //Request.Method.GET,URL,null我自己加的\r\n        JsonArrayRequest request = new JsonArrayRequest(Request.Method.GET,URL,null,\r\n                new Response.Listener<JSONArray>() {\r\n                    @Override\r\n                    public void onResponse(JSONArray array) {//////\r\n                        if (array.length()==0){\r\n                            dialog.show();\r\n                            clickme.setOnClickListener(new View.OnClickListener() {\r\n                                @Override\r\n                                public void onClick(View v) {\r\n                                    Intent intent = new Intent(my_contact.this,qrcode_page.class);\r\n                                    intent.putExtra(\"email\",getmail);\r\n                                    startActivity(intent);\r\n                                }\r\n                            });\r\n                        }else\r\n                            for(int i =0;i<array.length();i++){\r\n                                try {\r\n                                    JSONObject object = array.getJSONObject(i);\r\n                                    String name = object.getString(\"F_name\").trim();\r\n                                    String phone = object.getString(\"F_phone\").trim();\r\n\r\n                                    friend f =new friend();\r\n                                    f.setF_name(name);\r\n                                    f.setF_phone(phone);\r\n                                    friendList.add(f);\r\n\r\n                                } catch (JSONException e) {\r\n                                    e.printStackTrace();\r\n                                }\r\n                            }\r\n                        friendAdapter = new friendAdapter(my_contact.this,friendList);\r\n                        mrecyclerView.setAdapter(friendAdapter);\r\n\r\n                    }\r\n                }, new Response.ErrorListener() {\r\n            @Override\r\n            public void onErrorResponse(VolleyError error) {\r\n                Toast.makeText(my_contact.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n        RequestQueue requestQueue2 = Volley.newRequestQueue(my_contact.this);\r\n        requestQueue2.add(request);\r\n\r\n    }\r\n\r\n    private void LoadAllfriend() {\r\n\r\n    }\r\n\r\n    //抓取使用者基本資料\r\n    private void readUser(){\r\n        String URL =Urls.url1+\"/LoginRegister/fetch.php?email=\"+getmail;\r\n        JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(\r\n                Request.Method.GET,\r\n                URL,\r\n                null,\r\n                new Response.Listener<JSONObject>() {\r\n                    @Override\r\n                    public void onResponse(JSONObject response) {\r\n                        String fullname;\r\n                        try {\r\n                            fullname = response.getString(\"fullname\");\r\n                            mEnteredName.setText(fullname);\r\n                        } catch (JSONException e) {\r\n                            e.printStackTrace();\r\n                            Toast.makeText(my_contact.this, e.toString(), Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    }\r\n                },\r\n                new Response.ErrorListener() {\r\n                    @Override\r\n                    public void onErrorResponse(VolleyError error) {\r\n                        Toast.makeText(my_contact.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }\r\n        );\r\n        requestQueue.add(jsonObjectRequest);\r\n    }\r\n    public  void fetchimage(){\r\n        String URL =Urls.url1+\"/LoginRegister/fetchimage.php?email=\"+getmail;\r\n        StringRequest request = new StringRequest(Request.Method.GET, URL, new Response.Listener<String>() {\r\n            @Override\r\n            public void onResponse(String response) {\r\n                try {\r\n                    JSONObject jsonObject = new JSONObject(response);\r\n                    img  = jsonObject.getString(\"image\");\r\n\r\n                    ImageRetriveWithPicasso();\r\n                } catch (JSONException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n        }, new Response.ErrorListener() {\r\n            @Override\r\n            public void onErrorResponse(VolleyError error) {\r\n                Toast.makeText(my_contact.this,error.getMessage(),Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n        RequestQueue requestQueue = Volley.newRequestQueue(my_contact.this);\r\n        requestQueue.add(request);\r\n    }\r\n    public void ImageRetriveWithPicasso() {\r\n        String imgurl = Urls.url1+\"/LoginRegister/images/\"+img;\r\n        Picasso.with(this)\r\n\r\n                .load(imgurl)\r\n                .placeholder(R.drawable.profile)\r\n                .fit()\r\n                // .error(R.drawable.ic_error_black_24dp)\r\n                .into(mPforfilepic, new Callback() {\r\n                    @Override\r\n                    public void onSuccess() {\r\n                        // 圖片讀取完成\r\n                        Toast.makeText(my_contact.this, \"Success\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n\r\n                    @Override\r\n                    public void onError() {\r\n                        // 圖片讀取失敗\r\n                        //  Toast.makeText(Page8Activity.this, \"失敗拉幹\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n        System.out.println(imgurl);\r\n    }\r\n\r\n    public String mail(){\r\n        Bundle extras = getIntent().getExtras();\r\n        if (extras!=null){\r\n            email=extras.getString(\"email\");\r\n        }\r\n        return email;\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/easybus/my_contact.java	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/java/com/example/easybus/my_contact.java	(date 1632907667390)
@@ -7,6 +7,7 @@
 
 import android.app.Dialog;
 import android.content.Intent;
+import android.content.SharedPreferences;
 import android.graphics.Color;
 import android.graphics.drawable.ColorDrawable;
 import android.os.Bundle;
@@ -37,12 +38,17 @@
 import de.hdodenhof.circleimageview.CircleImageView;
 
 public class my_contact extends AppCompatActivity {
-    String email,getmail,img;
+    String email,getmail,img,img2,imgUrl,fimage;//
+    String femail;
+    String phone;
     TextView mEnteredName;
     ImageView backBtn;
     RequestQueue requestQueue;
     RecyclerView mrecyclerView;
+    RecyclerView imgrecyclerView;
     friendAdapter friendAdapter;
+    //ImageListAdapter imageListAdapter;
+    List<ImageList>imageLists;
     List<friend> friendList;
     Dialog dialog;
     Button clickme;
@@ -54,7 +60,9 @@
         //隱藏title bar///
         ActionBar actionBar = getSupportActionBar();
         actionBar.hide();
-
+        //抓email
+        SharedPreferences email = getSharedPreferences("email",MODE_PRIVATE);
+        getmail=email.getString("Email","");
         backBtn=findViewById(R.id.backicon);
         mEnteredName = findViewById(R.id.EnteredName);
         dialog = new Dialog(my_contact.this);
@@ -68,43 +76,46 @@
         LinearLayoutManager linearLayoutManager = new LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false);
         mrecyclerView=findViewById(R.id.recyclerview);
         mrecyclerView.setHasFixedSize(true);
-        // LinearLayoutManager llm = new LinearLayoutManager(this);
-        //llm.setOrientation(LinearLayoutManager.VERTICAL);
-        //mrecyclerView.setLayoutManager(new LinearLayoutManager(this));
         mrecyclerView.setLayoutManager(linearLayoutManager);
 
+        /*LinearLayoutManager ImageLayoutManager = new LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false);
+        imgrecyclerView=findViewById(R.id.imgrecyclerview);
+        imgrecyclerView.setHasFixedSize(true);
+        imgrecyclerView.setLayoutManager(ImageLayoutManager);*/
+
         friendList = new ArrayList<>();
+        imageLists =new ArrayList<>();
         //friendAdapter = new friendAdapter(my_contact.this,friendList);
         //mrecyclerView.setAdapter(friendAdapter);
         requestQueue = Volley.newRequestQueue(this);
-        getmail=mail();
+        //getmail=mail();
         readUser();
-        fetchimage();
-        ImageRetriveWithPicasso();
+        readfriend();
         //返回我的資料
         backBtn.setOnClickListener(new View.OnClickListener() {
             @Override
             public void onClick(View v) {
                 Intent intent = new Intent(my_contact.this,Page8Activity.class);
-                intent.putExtra("email",getmail);
+                //intent.putExtra("email",getmail);
                 startActivity(intent);
                 finish();
             }
         });
-
+    }
+    public void readfriend(){
         String URL =Urls.url1+"/LoginRegister/my_contact.php?email="+getmail;
         //Request.Method.GET,URL,null我自己加的
         JsonArrayRequest request = new JsonArrayRequest(Request.Method.GET,URL,null,
                 new Response.Listener<JSONArray>() {
                     @Override
-                    public void onResponse(JSONArray array) {//////
+                    public void onResponse(JSONArray array) {
                         if (array.length()==0){
                             dialog.show();
                             clickme.setOnClickListener(new View.OnClickListener() {
                                 @Override
                                 public void onClick(View v) {
                                     Intent intent = new Intent(my_contact.this,qrcode_page.class);
-                                    intent.putExtra("email",getmail);
+                                    // intent.putExtra("email",getmail);
                                     startActivity(intent);
                                 }
                             });
@@ -113,19 +124,34 @@
                                 try {
                                     JSONObject object = array.getJSONObject(i);
                                     String name = object.getString("F_name").trim();
-                                    String phone = object.getString("F_phone").trim();
+                                    phone = object.getString("F_phone").trim();
+                                    femail = object.getString("F_email").trim();
+                                    fimage = object.getString("F_image").trim();
 
                                     friend f =new friend();
                                     f.setF_name(name);
                                     f.setF_phone(phone);
+                                    f.setF_image(fimage);
+                                    //ImageList img = new ImageList();
+
+                                    f.setFemail(femail);
+                                    imgUrl = imgurlString(fimage);
+                                    f.setImageUrl(imgUrl);
+                                    //imageLists.add(img);
+                                    System.out.println(imgUrl);
+                                    //fetchfimage();
                                     friendList.add(f);
 
+
                                 } catch (JSONException e) {
                                     e.printStackTrace();
                                 }
                             }
-                        friendAdapter = new friendAdapter(my_contact.this,friendList);
+                        friendAdapter = new friendAdapter(my_contact.this,friendList,imageLists);
                         mrecyclerView.setAdapter(friendAdapter);
+                        /*imageListAdapter = new ImageListAdapter(my_contact.this, imageLists);
+                        mrecyclerView.setAdapter(imageListAdapter);
+                        //imgrecyclerView.setAdapter(imageListAdapter);*/
 
                     }
                 }, new Response.ErrorListener() {
@@ -136,7 +162,10 @@
         });
         RequestQueue requestQueue2 = Volley.newRequestQueue(my_contact.this);
         requestQueue2.add(request);
+    }
 
+    public String imgurlString(final String img2){
+        return Urls.url1+"/LoginRegister/images/"+img2;
     }
 
     private void LoadAllfriend() {
@@ -157,6 +186,7 @@
                         try {
                             fullname = response.getString("fullname");
                             mEnteredName.setText(fullname);
+                            fetchimage();
                         } catch (JSONException e) {
                             e.printStackTrace();
                             Toast.makeText(my_contact.this, e.toString(), Toast.LENGTH_SHORT).show();
@@ -180,7 +210,6 @@
                 try {
                     JSONObject jsonObject = new JSONObject(response);
                     img  = jsonObject.getString("image");
-
                     ImageRetriveWithPicasso();
                 } catch (JSONException e) {
                     e.printStackTrace();
@@ -218,12 +247,4 @@
                 });
         System.out.println(imgurl);
     }
-
-    public String mail(){
-        Bundle extras = getIntent().getExtras();
-        if (extras!=null){
-            email=extras.getString("email");
-        }
-        return email;
-    }
 }
\ No newline at end of file
Index: app/src/main/res/layout/contact_listview.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:orientation=\"horizontal\"\r\n    android:layout_width=\"356dp\"\r\n    android:layout_height=\"60dp\"\r\n    >\r\n\r\n    <TextView\r\n        android:id=\"@+id/fname\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginStart=\"52dp\"\r\n        android:layout_marginBottom=\"16dp\"\r\n        android:text=\"name\"\r\n        android:textSize=\"24sp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/fphone\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginEnd=\"28dp\"\r\n        android:layout_marginBottom=\"16dp\"\r\n        android:text=\"1234567890\"\r\n        android:textSize=\"24sp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\" />\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/contact_listview.xml	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/res/layout/contact_listview.xml	(date 1632907644071)
@@ -2,16 +2,23 @@
 <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res-auto"
     xmlns:tools="http://schemas.android.com/tools"
-    android:orientation="horizontal"
     android:layout_width="356dp"
     android:layout_height="60dp"
-    >
+    android:orientation="horizontal">
+
+    <de.hdodenhof.circleimageview.CircleImageView
+        android:id="@+id/imageView6"
+        android:layout_width="80dp"
+        android:layout_height="60dp"
+        android:src="@drawable/profile"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
 
     <TextView
         android:id="@+id/fname"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
-        android:layout_marginStart="52dp"
+        android:layout_marginStart="110dp"
         android:layout_marginBottom="16dp"
         android:text="name"
         android:textSize="24sp"
@@ -22,7 +29,7 @@
         android:id="@+id/fphone"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
-        android:layout_marginEnd="28dp"
+        android:layout_marginEnd="16dp"
         android:layout_marginBottom="16dp"
         android:text="1234567890"
         android:textSize="24sp"
Index: app/src/main/java/com/example/easybus/friendAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easybus;\r\n\r\nimport android.content.Context;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.AdapterView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport java.util.List;\r\n\r\npublic class friendAdapter extends RecyclerView.Adapter<friendAdapter.frinedHolder>{\r\n    Context context;\r\n    List<friend> friendList;\r\n    AdapterView.OnItemClickListener listener;\r\n    public friendAdapter(Context context, List<friend> friendList) {\r\n        this.context = context;\r\n        this.friendList = friendList;\r\n    }\r\n\r\n    @NonNull\r\n    //@org.jetbrains.annotations.NotNull\r\n    @Override\r\n    public frinedHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\r\n        View frinedlayout = LayoutInflater.from(parent.getContext()).inflate(R.layout.contact_listview,parent,false);\r\n        return new frinedHolder(frinedlayout);\r\n    }\r\n\r\n    @Override\r\n    public void onBindViewHolder(@NonNull final friendAdapter.frinedHolder holder, final int position) {\r\n        friend f = friendList.get(position);\r\n        holder.mf_name.setText(f.getF_name());\r\n        holder.mf_phone.setText(f.getF_phone());\r\n    }\r\n\r\n    @Override\r\n    public int getItemCount() {\r\n        return friendList.size();\r\n    }\r\n\r\n    public class frinedHolder extends RecyclerView.ViewHolder {\r\n        TextView mf_name,mf_phone;\r\n        public frinedHolder(@NonNull View itemView) {\r\n            super(itemView);\r\n            mf_name=itemView.findViewById(R.id.fname);\r\n            mf_phone=itemView.findViewById(R.id.fphone);\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/easybus/friendAdapter.java	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/java/com/example/easybus/friendAdapter.java	(date 1632907610849)
@@ -5,21 +5,26 @@
 import android.view.View;
 import android.view.ViewGroup;
 import android.widget.AdapterView;
+import android.widget.ImageView;
 import android.widget.TextView;
 import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.recyclerview.widget.RecyclerView;
 
+import com.squareup.picasso.Picasso;
+
 import java.util.List;
 
 public class friendAdapter extends RecyclerView.Adapter<friendAdapter.frinedHolder>{
     Context context;
     List<friend> friendList;
+    List<ImageList> imageLists;
     AdapterView.OnItemClickListener listener;
-    public friendAdapter(Context context, List<friend> friendList) {
+    public friendAdapter(Context context, List<friend> friendList,List<ImageList> imageLists) {
         this.context = context;
         this.friendList = friendList;
+        this.imageLists = imageLists;
     }
 
     @NonNull
@@ -35,6 +40,7 @@
         friend f = friendList.get(position);
         holder.mf_name.setText(f.getF_name());
         holder.mf_phone.setText(f.getF_phone());
+        Picasso.with(context).load(f.getImageUrl()).into(holder.img);
     }
 
     @Override
@@ -44,10 +50,12 @@
 
     public class frinedHolder extends RecyclerView.ViewHolder {
         TextView mf_name,mf_phone;
+        ImageView img;
         public frinedHolder(@NonNull View itemView) {
             super(itemView);
             mf_name=itemView.findViewById(R.id.fname);
             mf_phone=itemView.findViewById(R.id.fphone);
+            img = itemView.findViewById(R.id.imageView6);
         }
     }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/easybus/qrscanner.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easybus;\r\n\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.ActionBar;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.app.Dialog;\r\nimport android.content.Intent;\r\nimport android.graphics.Color;\r\nimport android.graphics.drawable.ColorDrawable;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.android.volley.AuthFailureError;\r\nimport com.android.volley.Request;\r\nimport com.android.volley.RequestQueue;\r\nimport com.android.volley.Response;\r\nimport com.android.volley.VolleyError;\r\nimport com.android.volley.toolbox.JsonObjectRequest;\r\nimport com.android.volley.toolbox.StringRequest;\r\nimport com.android.volley.toolbox.Volley;\r\nimport com.google.zxing.integration.android.IntentIntegrator;\r\nimport com.google.zxing.integration.android.IntentResult;\r\n\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class qrscanner extends AppCompatActivity {\r\n    String f_email,email,mygetmail;\r\n    RequestQueue requestQueue, requestQueue1;\r\n    Dialog dialog,fdialog;\r\n    //判斷是否加好友、判斷是否存在\r\n    Button btnok,btncancle,btngo;\r\n    TextView maddfriend,friendname,myfriend,back;\r\n    //private PopupWindow popupWindow = null;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_qrscanner);\r\n\r\n        back=findViewById(R.id.back);\r\n        back.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(qrscanner.this,Page8Activity.class);\r\n                intent.putExtra(\"email\",mygetmail);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n\r\n        ActionBar actionBar = getSupportActionBar();\r\n        actionBar.hide();\r\n        mygetmail=mail();\r\n        requestQueue1 = Volley.newRequestQueue(this);\r\n        requestQueue = Volley.newRequestQueue(this);\r\n        //Initialize intent integrator\r\n        IntentIntegrator intentIntegrator = new IntentIntegrator(qrscanner.this);\r\n        //Set prompt text\r\n        intentIntegrator.setPrompt(\"請將QRcode對準\");\r\n        //Set beep\r\n        intentIntegrator.setBeepEnabled(true);\r\n        //Locked orientation\r\n        intentIntegrator.setOrientationLocked(true);\r\n        //Set capture activity\r\n        intentIntegrator.setCaptureActivity(Capture.class);\r\n        //Initiate scan\r\n        intentIntegrator.initiateScan();\r\n        dialog = new Dialog(qrscanner.this);\r\n        fdialog = new Dialog(qrscanner.this);\r\n\r\n        dialog.setContentView(R.layout.activity_scan_dialog);\r\n        //刪除dialog方方的背景\r\n        dialog.getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT));\r\n        btnok = dialog.findViewById(R.id.okok);\r\n        btncancle = dialog.findViewById(R.id.canclecancle);\r\n        maddfriend = dialog.findViewById(R.id.addfriend);\r\n\r\n\r\n        fdialog.getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT));\r\n        fdialog.setContentView(R.layout.myfriend_dialog);\r\n        btngo = fdialog.findViewById(R.id.button10);\r\n        myfriend = fdialog.findViewById(R.id.myfriend);\r\n\r\n\r\n\r\n\r\n    }\r\n    public void addfriend(final String f_name,final String f_email,final String f_phone){\r\n        String URL =Urls.url1+\"/LoginRegister/addfriend.php?email=\"+mygetmail;\r\n        //\r\n        StringRequest stringRequest = new StringRequest(\r\n                Request.Method.POST,\r\n                URL,\r\n                new Response.Listener<String>() {\r\n                    @Override\r\n                    public void onResponse(String response) {\r\n                        if(response.equals(\"Success\")){\r\n                            Toast.makeText(qrscanner.this, \"加入成功 !\", Toast.LENGTH_SHORT).show();\r\n                        }else{\r\n                            Toast.makeText(qrscanner.this, \"已為聯絡人\", Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    }\r\n                },\r\n                new Response.ErrorListener() {\r\n                    @Override\r\n                    public void onErrorResponse(VolleyError error) {\r\n                        Toast.makeText(qrscanner.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }\r\n        ) {\r\n            @Nullable\r\n            @Override\r\n            protected Map<String, String> getParams() throws AuthFailureError {\r\n                Map<String, String> parms = new HashMap<>();\r\n                //引號內是key值;\r\n                parms.put(\"email\", mygetmail);\r\n                parms.put(\"f_name\", f_name);\r\n                parms.put(\"f_email\", f_email);\r\n                parms.put(\"f_phone\", f_phone);\r\n                return parms;\r\n            }\r\n        };\r\n        requestQueue1.add(stringRequest);\r\n    }\r\n    //加好友用的readUser\r\n    public void readUser2(final String f_email){\r\n        String URL =Urls.url1+\"/LoginRegister/fetch.php?email=\"+f_email;\r\n        JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(\r\n                Request.Method.GET,\r\n                URL,\r\n                null,\r\n                new Response.Listener<JSONObject>() {\r\n                    String f_name,f_phone;\r\n                    @Override\r\n                    public void onResponse(JSONObject response) {\r\n                        try {\r\n                            f_name = response.getString(\"fullname\");\r\n                            f_phone = response.getString(\"userphone\");\r\n                            addfriend(f_name,f_email,f_phone);\r\n                        } catch (JSONException e) {\r\n                            e.printStackTrace();\r\n                            Toast.makeText(qrscanner.this, e.toString(), Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    }\r\n                },\r\n                new Response.ErrorListener() {\r\n                    @Override\r\n                    public void onErrorResponse(VolleyError error) {\r\n                        Toast.makeText(qrscanner.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }\r\n        );\r\n        requestQueue.add(jsonObjectRequest);\r\n    }\r\n\r\n//判斷好柚是否已經存在friendexist\r\n\r\n    public void friendexist(final String f_email) {\r\n        String URL =Urls.url1+\"/LoginRegister/friend_exist.php?email=\"+mygetmail+\"&f_email=\"+f_email;\r\n        StringRequest stringRequest = new StringRequest(\r\n                Request.Method.POST,\r\n                URL,\r\n                new Response.Listener<String>() {\r\n                    @Override\r\n                    public void onResponse(String response) {\r\n                        if(response.equals(\"existed\")){\r\n                            btngo.setOnClickListener(new View.OnClickListener() {\r\n                                @Override\r\n                                public void onClick(View v) {\r\n                                    fdialog.dismiss();\r\n                                    Intent intent = new Intent(qrscanner.this,my_contact.class);\r\n                                    intent.putExtra(\"email\",mygetmail);\r\n                                    startActivity(intent);\r\n                                }\r\n                            });\r\n                            fdialog.show();\r\n                           // Toast.makeText(emergency_contact.this, s, Toast.LENGTH_SHORT).show();\r\n                        }else{\r\n                            readUser(f_email);\r\n\r\n                            btnok.setOnClickListener(new View.OnClickListener() {\r\n                                @Override\r\n                                public void onClick(View v) {\r\n                                    dialog.dismiss();\r\n                                    readUser2(f_email);\r\n                                    Intent intent = new Intent(qrscanner.this,Page8Activity.class);\r\n                                    intent.putExtra(\"email\",mygetmail);\r\n                                    startActivity(intent);\r\n                                }\r\n                            });\r\n                            btncancle.setOnClickListener(new View.OnClickListener() {\r\n                                @Override\r\n                                public void onClick(View v) {\r\n                                    dialog.dismiss();\r\n                                    Intent intent = new Intent(qrscanner.this,Page8Activity.class);\r\n                                    intent.putExtra(\"email\",mygetmail);\r\n                                    startActivity(intent);\r\n                                }\r\n                            });\r\n\r\n                            dialog.show();\r\n                        }\r\n                    }\r\n                },\r\n                new Response.ErrorListener() {\r\n                    @Override\r\n                    public void onErrorResponse(VolleyError error) {\r\n                        Toast.makeText(qrscanner.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }\r\n        ) ;\r\n        requestQueue.add(stringRequest);\r\n    }\r\n\r\n\r\n    public void readUser(final String f_email){\r\n        String URL =Urls.url1+\"/LoginRegister/fetch.php?email=\"+f_email;\r\n        JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(\r\n                Request.Method.GET,\r\n                URL,\r\n                null,\r\n                new Response.Listener<JSONObject>() {\r\n                    String f_name,f_phone;\r\n                    @Override\r\n                    public void onResponse(JSONObject response) {\r\n                        try {\r\n                            f_name = response.getString(\"fullname\");\r\n                            //dialog內的TextView\r\n                            maddfriend.setText(\"是否加入\\n\"+f_name+\"\\n為聯絡人\");\r\n                        } catch (JSONException e) {\r\n                            e.printStackTrace();\r\n                            Toast.makeText(qrscanner.this, e.toString(), Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    }\r\n                },\r\n                new Response.ErrorListener() {\r\n                    @Override\r\n                    public void onErrorResponse(VolleyError error) {\r\n                        Toast.makeText(qrscanner.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }\r\n        );\r\n        requestQueue.add(jsonObjectRequest);\r\n    }\r\n\r\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        //Initialize intent result\r\n        IntentResult intentResult = IntentIntegrator.parseActivityResult(\r\n                requestCode, resultCode, data);\r\n        if(intentResult.getContents()!=null){\r\n            //when reuslt content not null\r\n            f_email = intentResult.getContents();\r\n            friendexist(f_email);\r\n            //如果聯絡人存在fdialog\r\n            //如果這個聯絡人不存在 -> else readUser() -> dialog.show() -> 點確認 readUser2() ->返回page8\r\n                                                                  //-> 點取消 -> 返回page8\r\n        }else{\r\n            Toast.makeText(getApplicationContext(), \"掃描失敗\", Toast.LENGTH_SHORT).show();\r\n        }\r\n    }\r\n\r\n    public String mail(){\r\n        Bundle extras = getIntent().getExtras();\r\n        if (extras!=null){\r\n            email=extras.getString(\"email\");\r\n        }\r\n        return email;\r\n    }\r\n//悲劇\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/easybus/qrscanner.java	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/java/com/example/easybus/qrscanner.java	(date 1632907461211)
@@ -6,11 +6,13 @@
 
 import android.app.Dialog;
 import android.content.Intent;
+import android.content.SharedPreferences;
 import android.graphics.Color;
 import android.graphics.drawable.ColorDrawable;
 import android.os.Bundle;
 import android.view.View;
 import android.widget.Button;
+import android.widget.ImageButton;
 import android.widget.TextView;
 import android.widget.Toast;
 
@@ -37,26 +39,29 @@
     Dialog dialog,fdialog;
     //判斷是否加好友、判斷是否存在
     Button btnok,btncancle,btngo;
-    TextView maddfriend,friendname,myfriend,back;
+    TextView maddfriend,friendname,myfriend;
+    ImageButton back;
     //private PopupWindow popupWindow = null;
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_qrscanner);
-
+        //抓email
+        SharedPreferences email = getSharedPreferences("email",MODE_PRIVATE);
+        mygetmail=email.getString("Email","");
         back=findViewById(R.id.back);
         back.setOnClickListener(new View.OnClickListener() {
             @Override
             public void onClick(View v) {
                 Intent intent = new Intent(qrscanner.this,Page8Activity.class);
-                intent.putExtra("email",mygetmail);
+                // intent.putExtra("email",mygetmail);
                 startActivity(intent);
             }
         });
 
         ActionBar actionBar = getSupportActionBar();
         actionBar.hide();
-        mygetmail=mail();
+        //mygetmail=mail();
         requestQueue1 = Volley.newRequestQueue(this);
         requestQueue = Volley.newRequestQueue(this);
         //Initialize intent integrator
@@ -91,7 +96,7 @@
 
 
     }
-    public void addfriend(final String f_name,final String f_email,final String f_phone){
+    public void addfriend(final String f_name,final String f_email,final String f_phone,final String f_image){
         String URL =Urls.url1+"/LoginRegister/addfriend.php?email="+mygetmail;
         //
         StringRequest stringRequest = new StringRequest(
@@ -123,6 +128,7 @@
                 parms.put("f_name", f_name);
                 parms.put("f_email", f_email);
                 parms.put("f_phone", f_phone);
+                parms.put("f_image",f_image);
                 return parms;
             }
         };
@@ -136,13 +142,14 @@
                 URL,
                 null,
                 new Response.Listener<JSONObject>() {
-                    String f_name,f_phone;
+                    String f_name,f_phone,f_image;
                     @Override
                     public void onResponse(JSONObject response) {
                         try {
                             f_name = response.getString("fullname");
                             f_phone = response.getString("userphone");
-                            addfriend(f_name,f_email,f_phone);
+                            f_image = response.getString("image");
+                            addfriend(f_name,f_email,f_phone,f_image);
                         } catch (JSONException e) {
                             e.printStackTrace();
                             Toast.makeText(qrscanner.this, e.toString(), Toast.LENGTH_SHORT).show();
@@ -180,7 +187,7 @@
                                 }
                             });
                             fdialog.show();
-                           // Toast.makeText(emergency_contact.this, s, Toast.LENGTH_SHORT).show();
+                            // Toast.makeText(emergency_contact.this, s, Toast.LENGTH_SHORT).show();
                         }else{
                             readUser(f_email);
 
@@ -260,18 +267,11 @@
             friendexist(f_email);
             //如果聯絡人存在fdialog
             //如果這個聯絡人不存在 -> else readUser() -> dialog.show() -> 點確認 readUser2() ->返回page8
-                                                                  //-> 點取消 -> 返回page8
+            //-> 點取消 -> 返回page8
         }else{
             Toast.makeText(getApplicationContext(), "掃描失敗", Toast.LENGTH_SHORT).show();
         }
     }
 
-    public String mail(){
-        Bundle extras = getIntent().getExtras();
-        if (extras!=null){
-            email=extras.getString("email");
-        }
-        return email;
-    }
 //悲劇
 }
\ No newline at end of file
Index: app/src/main/res/values/styles.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><resources>\r\n\r\n    <!-- Base application theme. -->\r\n    <style name=\"AppTheme\" parent=\"Theme.AppCompat.Light.DarkActionBar\">\r\n        <!-- Customize your theme here. -->\r\n        <item name=\"colorPrimary\">@color/colorPrimary</item>\r\n        <item name=\"colorPrimaryDark\">@color/colorPrimaryDark</item>\r\n        <item name=\"colorAccent\">@color/colorAccent</item>\r\n    </style>\r\n\r\n    <style name=\"FullscreenTheme\" parent=\"AppTheme\">\r\n        <item name=\"android:actionBarStyle\">@style/FullscreenActionBarStyle</item>\r\n        <item name=\"android:windowActionBarOverlay\">true</item>\r\n        <item name=\"android:windowBackground\">@null</item>\r\n        <item name=\"metaButtonBarStyle\">?android:attr/buttonBarStyle</item>\r\n        <item name=\"metaButtonBarButtonStyle\">?android:attr/buttonBarButtonStyle</item>\r\n    </style>\r\n\r\n    <style name=\"FullscreenActionBarStyle\" parent=\"Widget.AppCompat.ActionBar\">\r\n        <item name=\"android:background\">@color/black_overlay</item>\r\n    </style>\r\n\r\n</resources>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/values/styles.xml	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/res/values/styles.xml	(date 1632907986256)
@@ -4,7 +4,7 @@
     <style name="AppTheme" parent="Theme.AppCompat.Light.DarkActionBar">
         <!-- Customize your theme here. -->
         <item name="colorPrimary">@color/colorPrimary</item>
-        <item name="colorPrimaryDark">@color/colorPrimaryDark</item>
+        <item name="colorPrimaryDark">@color/black_overlay</item>
         <item name="colorAccent">@color/colorAccent</item>
     </style>
 
Index: .idea/encodings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/encodings.xml	(date 1632904362139)
+++ .idea/encodings.xml	(date 1632904362139)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="Encoding">
+    <file url="PROJECT" charset="UTF-8" />
+  </component>
+</project>
\ No newline at end of file
Index: app/google-services.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\r\n  \"project_info\": {\r\n    \"project_number\": \"1066237684460\",\r\n    \"firebase_url\": \"https://easybus-f36e9.firebaseio.com\",\r\n    \"project_id\": \"easybus-f36e9\",\r\n    \"storage_bucket\": \"easybus-f36e9.appspot.com\"\r\n  },\r\n  \"client\": [\r\n    {\r\n      \"client_info\": {\r\n        \"mobilesdk_app_id\": \"1:1066237684460:android:9db6c09bd08528959913c9\",\r\n        \"android_client_info\": {\r\n          \"package_name\": \"com.example.easybus\"\r\n        }\r\n      },\r\n      \"oauth_client\": [\r\n        {\r\n          \"client_id\": \"1066237684460-g03u7ji1cr9o3mj0vjb5ptqsghpg67jb.apps.googleusercontent.com\",\r\n          \"client_type\": 1,\r\n          \"android_info\": {\r\n            \"package_name\": \"com.example.easybus\",\r\n            \"certificate_hash\": \"58639c1aa2ef9fac8bc6a1ddf32784960fe17d20\"\r\n          }\r\n        },\r\n        {\r\n          \"client_id\": \"1066237684460-oqf5ocgp72sepomilq3tb96cm35nlnh4.apps.googleusercontent.com\",\r\n          \"client_type\": 1,\r\n          \"android_info\": {\r\n            \"package_name\": \"com.example.easybus\",\r\n            \"certificate_hash\": \"58807ce5da30fac3b2b973297be286d1743947a3\"\r\n          }\r\n        },\r\n        {\r\n          \"client_id\": \"1066237684460-04u1t8ci16l7p1c0dsq18304o805hn5p.apps.googleusercontent.com\",\r\n          \"client_type\": 3\r\n        }\r\n      ],\r\n      \"api_key\": [\r\n        {\r\n          \"current_key\": \"AIzaSyDRImYvIyRmi4q1XixWy2oqus3QSL_GQNc\"\r\n        }\r\n      ],\r\n      \"services\": {\r\n        \"appinvite_service\": {\r\n          \"other_platform_oauth_client\": [\r\n            {\r\n              \"client_id\": \"1066237684460-04u1t8ci16l7p1c0dsq18304o805hn5p.apps.googleusercontent.com\",\r\n              \"client_type\": 3\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  ],\r\n  \"configuration_version\": \"1\"\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/google-services.json	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/google-services.json	(date 1632904362132)
@@ -27,7 +27,7 @@
           "client_type": 1,
           "android_info": {
             "package_name": "com.example.easybus",
-            "certificate_hash": "58807ce5da30fac3b2b973297be286d1743947a3"
+            "certificate_hash": "58639c1aa2ef9fac8bc6a1ddf32784960fe17d20"
           }
         },
         {
Index: app/src/main/res/layout/activity_qrscanner.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"#FFFFFF\"\r\n    tools:context=\".qrscanner\">\r\n\r\n    <TextView\r\n        android:id=\"@+id/title\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginLeft=\"35dp\"\r\n        android:layout_marginTop=\"5dp\"\r\n        android:text=\"QR掃描器\"\r\n        android:textColor=\"@android:color/black\"\r\n        android:textSize=\"40dp\"\r\n        android:textStyle=\"bold\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.172\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/logo\" />\r\n\r\n    <ImageView\r\n        android:id=\"@+id/logo\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"75dp\"\r\n        android:layout_marginTop=\"4dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.0\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:srcCompat=\"@drawable/logo\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/back\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:text=\"返回上一頁\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.865\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:layout_constraintVertical_bias=\"0.862\" />\r\n\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_qrscanner.xml	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/res/layout/activity_qrscanner.xml	(date 1632907219480)
@@ -7,42 +7,63 @@
     android:background="#FFFFFF"
     tools:context=".qrscanner">
 
-    <TextView
-        android:id="@+id/title"
-        android:layout_width="match_parent"
-        android:layout_height="wrap_content"
-        android:layout_marginLeft="35dp"
-        android:layout_marginTop="5dp"
-        android:text="QR掃描器"
-        android:textColor="@android:color/black"
-        android:textSize="40dp"
-        android:textStyle="bold"
+    <View
+        android:id="@+id/top"
+        android:layout_width="405dp"
+        android:layout_height="95dp"
+        android:background="@drawable/round_button"
+        android:visibility="visible"
         app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintHorizontal_bias="0.172"
         app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintTop_toBottomOf="@+id/logo" />
+        app:layout_constraintTop_toTopOf="parent" />
 
-    <ImageView
-        android:id="@+id/logo"
-        android:layout_width="wrap_content"
-        android:layout_height="75dp"
-        android:layout_marginTop="4dp"
-        app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintHorizontal_bias="0.0"
+    <ImageButton
+        android:id="@+id/back"
+        android:layout_width="85dp"
+        android:layout_height="85dp"
+        android:layout_marginTop="8dp"
+        android:scaleType="fitCenter"
+        app:layout_constraintEnd_toEndOf="@+id/top"
+        app:layout_constraintHorizontal_bias="0.009"
         app:layout_constraintStart_toStartOf="parent"
         app:layout_constraintTop_toTopOf="parent"
-        app:srcCompat="@drawable/logo" />
+        app:srcCompat="@drawable/back" />
 
-    <TextView
-        android:id="@+id/back"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        android:text="返回上一頁"
-        app:layout_constraintBottom_toBottomOf="parent"
+    <ImageView
+        android:id="@+id/iv1"
+        android:layout_width="275dp"
+        android:layout_height="64dp"
+        android:layout_marginTop="16dp"
         app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintHorizontal_bias="0.865"
-        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintHorizontal_bias="0.395"
+        app:layout_constraintStart_toEndOf="@+id/back"
         app:layout_constraintTop_toTopOf="parent"
-        app:layout_constraintVertical_bias="0.862" />
+        app:srcCompat="@drawable/page5up" />
+
+    <ImageView
+        android:id="@+id/iv2"
+        android:layout_width="63dp"
+        android:layout_height="42dp"
+        app:srcCompat="@drawable/qrcode"
+        app:layout_constraintTop_toTopOf="@+id/iv1"
+        app:layout_constraintBottom_toBottomOf="@+id/iv1"
+        app:layout_constraintStart_toStartOf="@+id/iv1"
+        app:layout_constraintEnd_toStartOf="@+id/gps_time"
+        tools:layout_editor_absoluteX="122dp"
+        tools:layout_editor_absoluteY="29dp" />
+
+    <TextView
+        android:id="@+id/gps_time"
+        android:layout_width="168dp"
+        android:layout_height="42dp"
+        android:gravity="center"
+        android:text="QR掃描器"
+        android:textColor="#000000"
+        android:textSize="22sp"
+        android:textStyle="bold"
+        app:layout_constraintBottom_toBottomOf="@+id/iv1"
+        app:layout_constraintEnd_toEndOf="@+id/iv1"
+        app:layout_constraintStart_toEndOf="@+id/iv2"
+        app:layout_constraintTop_toTopOf="@+id/iv1" />
 
 </androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
Index: app/src/main/res/layout/activity_qrcode_page.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"#FFFFFF\"\r\n    tools:context=\".qrcode_page\">\r\n\r\n    <TextView\r\n        android:id=\"@+id/title\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginLeft=\"35dp\"\r\n        android:layout_marginTop=\"5dp\"\r\n        android:background=\"#FFFFFF\"\r\n        android:text=\"QRcode\"\r\n        android:textColor=\"@android:color/black\"\r\n        android:textSize=\"40dp\"\r\n        android:textStyle=\"bold\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.172\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toBottomOf=\"@+id/logo\" />\r\n\r\n    <ImageView\r\n        android:id=\"@+id/logo\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"75dp\"\r\n        android:layout_marginTop=\"4dp\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.0\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:srcCompat=\"@drawable/logo\" />\r\n\r\n    <ImageView\r\n        android:id=\"@+id/qrimage\"\r\n        android:layout_width=\"325dp\"\r\n        android:layout_height=\"322dp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:srcCompat=\"@drawable/qrcode\" />\r\n\r\n    <ImageView\r\n        android:id=\"@+id/qrscan_btn\"\r\n        android:layout_width=\"354dp\"\r\n        android:layout_height=\"56dp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.491\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:layout_constraintVertical_bias=\"0.9\"\r\n        app:srcCompat=\"@drawable/qrsan_btn\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/textView\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:text=\"掃描行動條碼\"\r\n        android:textColor=\"#000000\"\r\n        android:textSize=\"24sp\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.614\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:layout_constraintVertical_bias=\"0.885\" />\r\n\r\n    <TextView\r\n        android:id=\"@+id/back\"\r\n        android:layout_width=\"wrap_content\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:text=\"返回前一頁\"\r\n        app:layout_constraintBottom_toBottomOf=\"parent\"\r\n        app:layout_constraintEnd_toEndOf=\"parent\"\r\n        app:layout_constraintHorizontal_bias=\"0.873\"\r\n        app:layout_constraintStart_toStartOf=\"parent\"\r\n        app:layout_constraintTop_toTopOf=\"parent\"\r\n        app:layout_constraintVertical_bias=\"0.775\" />\r\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_qrcode_page.xml	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/res/layout/activity_qrcode_page.xml	(date 1632907202951)
@@ -7,32 +7,64 @@
     android:background="#FFFFFF"
     tools:context=".qrcode_page">
 
-    <TextView
-        android:id="@+id/title"
-        android:layout_width="match_parent"
-        android:layout_height="wrap_content"
-        android:layout_marginLeft="35dp"
-        android:layout_marginTop="5dp"
-        android:background="#FFFFFF"
-        android:text="QRcode"
-        android:textColor="@android:color/black"
-        android:textSize="40dp"
-        android:textStyle="bold"
+    <View
+        android:id="@+id/top"
+        android:layout_width="405dp"
+        android:layout_height="95dp"
+        android:background="@drawable/round_button"
+        android:visibility="visible"
         app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintHorizontal_bias="0.172"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <ImageButton
+        android:id="@+id/back"
+        android:layout_width="85dp"
+        android:layout_height="85dp"
+        android:layout_marginTop="8dp"
+        android:scaleType="fitCenter"
+        app:layout_constraintEnd_toEndOf="@+id/top"
+        app:layout_constraintHorizontal_bias="0.009"
         app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintTop_toBottomOf="@+id/logo" />
+        app:layout_constraintTop_toTopOf="parent"
+        app:srcCompat="@drawable/back" />
 
     <ImageView
-        android:id="@+id/logo"
-        android:layout_width="wrap_content"
-        android:layout_height="75dp"
-        android:layout_marginTop="4dp"
+        android:id="@+id/iv1"
+        android:layout_width="275dp"
+        android:layout_height="64dp"
+        android:layout_marginTop="16dp"
         app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintHorizontal_bias="0.0"
-        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintHorizontal_bias="0.395"
+        app:layout_constraintStart_toEndOf="@+id/back"
         app:layout_constraintTop_toTopOf="parent"
-        app:srcCompat="@drawable/logo" />
+        app:srcCompat="@drawable/page5up" />
+
+    <ImageView
+        android:id="@+id/iv2"
+        android:layout_width="63dp"
+        android:layout_height="42dp"
+        app:srcCompat="@drawable/qrcode"
+        app:layout_constraintTop_toTopOf="@+id/iv1"
+        app:layout_constraintBottom_toBottomOf="@+id/iv1"
+        app:layout_constraintStart_toStartOf="@+id/iv1"
+        app:layout_constraintEnd_toStartOf="@+id/gps_time"
+        tools:layout_editor_absoluteX="122dp"
+        tools:layout_editor_absoluteY="29dp" />
+
+    <TextView
+        android:id="@+id/gps_time"
+        android:layout_width="168dp"
+        android:layout_height="42dp"
+        android:gravity="center"
+        android:text="QRCODE加朋友"
+        android:textColor="#000000"
+        android:textSize="22sp"
+        android:textStyle="bold"
+        app:layout_constraintBottom_toBottomOf="@+id/iv1"
+        app:layout_constraintEnd_toEndOf="@+id/iv1"
+        app:layout_constraintStart_toEndOf="@+id/iv2"
+        app:layout_constraintTop_toTopOf="@+id/iv1" />
 
     <ImageView
         android:id="@+id/qrimage"
@@ -70,15 +102,5 @@
         app:layout_constraintTop_toTopOf="parent"
         app:layout_constraintVertical_bias="0.885" />
 
-    <TextView
-        android:id="@+id/back"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        android:text="返回前一頁"
-        app:layout_constraintBottom_toBottomOf="parent"
-        app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintHorizontal_bias="0.873"
-        app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintTop_toTopOf="parent"
-        app:layout_constraintVertical_bias="0.775" />
+
 </androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
Index: app/src/main/java/com/example/easybus/Page8Activity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easybus;\r\n\r\n\r\nimport android.Manifest;\r\nimport android.app.Activity;\r\nimport android.content.ContentResolver;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.net.Uri;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.os.Environment;\r\nimport android.os.Handler;\r\nimport android.os.Looper;\r\nimport android.provider.MediaStore;\r\nimport android.util.Base64;\r\nimport android.view.Gravity;\r\nimport android.view.View;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.ActionBar;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.core.content.ContextCompat;\r\nimport androidx.core.content.FileProvider;\r\n\r\nimport com.android.volley.AuthFailureError;\r\nimport com.android.volley.Request;\r\nimport com.android.volley.RequestQueue;\r\nimport com.android.volley.Response;\r\nimport com.android.volley.VolleyError;\r\nimport com.android.volley.toolbox.JsonObjectRequest;\r\nimport com.android.volley.toolbox.StringRequest;\r\nimport com.android.volley.toolbox.Volley;\r\nimport com.squareup.picasso.Callback;\r\nimport com.squareup.picasso.Picasso;\r\nimport com.vishnusivadas.advanced_httpurlconnection.PutData;\r\n\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.File;\r\nimport java.io.FileNotFoundException;\r\nimport java.io.IOException;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\n\r\npublic class Page8Activity extends AppCompatActivity {\r\n    SelectPicPopupWindow menuWindow; //自訂義的彈出框類別(SelectPicPopupWindow)\r\n\r\n    ImageView backBtn,editpassword,qrcode,emergency,mycontact,logout;\r\n    CircleImageView mPforfilepic;\r\n\r\n    TextView mEnteredName,myphone;\r\n    String identity;\r\n    public static final int SELECT_PHOTO=1;\r\n    public static final int TAKE_PHOTO = 3;\r\n    private Uri imageUri;\r\n    private Context mContext;\r\n    public String email,getmail,password,getpass,fullname,pic,phone,encodeimage,img;\r\n    RequestQueue requestQueue;\r\n    String url =Urls.url1+\"/LoginRegister/savepic.php?fullname=\"+fullname;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_page8);\r\n\r\n        //隱藏title bar\r\n        ActionBar actionBar = getSupportActionBar();\r\n        actionBar.hide();\r\n\r\n        backBtn=findViewById(R.id.backicon);\r\n        mEnteredName = findViewById(R.id.EnteredName);\r\n        mPforfilepic = findViewById(R.id.profilepic);\r\n        myphone = findViewById(R.id.txt1);\r\n        editpassword=findViewById(R.id.frame2);\r\n        qrcode = findViewById(R.id.frame3);\r\n        emergency = findViewById(R.id.frame4);\r\n        mycontact = findViewById(R.id.frame5);\r\n        logout = findViewById(R.id.frame8);\r\n        mContext = Page8Activity.this;\r\n\r\n        requestQueue = Volley.newRequestQueue(this);\r\n        getmail=mail();\r\n        getpass=pass();\r\n        readUser();\r\n        fetchimage();\r\n        ImageRetriveWithPicasso();\r\n        //我的聯絡人\r\n        mycontact.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(Page8Activity.this,my_contact.class);\r\n                intent.putExtra(\"email\",getmail);\r\n                startActivity(intent);\r\n                finish();\r\n            }\r\n        });\r\n        //新增緊急聯絡人\r\n        emergency.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(Page8Activity.this,emergency_contact.class);\r\n                intent.putExtra(\"email\",getmail);\r\n                startActivity(intent);\r\n                finish();\r\n            }\r\n        });\r\n        //登出\r\n        logout.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                SharedPreferences email = getSharedPreferences(\"email\",MODE_PRIVATE);\r\n                email.edit().clear().commit();\r\n                Intent it = new Intent(Page8Activity.this,Login3.class);\r\n                startActivity(it);\r\n            }\r\n        });\r\n\r\n        //QRcode\r\n        qrcode.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(Page8Activity.this,qrcode_page.class);\r\n                intent.putExtra(\"email\",getmail);\r\n                startActivity(intent);\r\n                finish();\r\n            }\r\n        });\r\n\r\n        //修改密碼\r\n        editpassword.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(Page8Activity.this,edit_password.class);\r\n                intent.putExtra(\"email\",getmail);\r\n                intent.putExtra(\"password\",getpass);\r\n                startActivity(intent);\r\n                finish();\r\n\r\n            }\r\n        });\r\n        //返回健(回選單)\r\n        backBtn.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                if(\"requester\".equalsIgnoreCase(identity)) {\r\n                    Intent it4 = new Intent(Page8Activity.this, Page3Activity.class);\r\n                    it4.putExtra(\"email\", getmail);\r\n                    startActivity(it4);\r\n                }else if(\"caregiver\".equalsIgnoreCase(identity)){\r\n                    Intent it = new Intent(Page8Activity.this,Page4Activity.class);\r\n                    it.putExtra(\"email\",getmail);\r\n                    startActivity(it);\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n        mPforfilepic.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                //實例化SelectPicPopupWindow\r\n                menuWindow = new SelectPicPopupWindow(Page8Activity.this, itemsOnClick);\r\n                //設計彈出框\r\n                menuWindow.showAtLocation(Page8Activity.this.findViewById(R.id.profilepic), Gravity.BOTTOM | Gravity.CENTER_HORIZONTAL, 0, 0);\r\n            }\r\n        });\r\n    }\r\n    //抓取使用者基本資料\r\n    public void readUser(){\r\n        String URL =Urls.url1+\"/LoginRegister/fetch.php?email=\"+getmail;\r\n        JsonObjectRequest jsonObjectRequest = new JsonObjectRequest(\r\n                Request.Method.GET,\r\n                URL,\r\n                null,\r\n                new Response.Listener<JSONObject>() {\r\n                    @Override\r\n                    public void onResponse(JSONObject response) {\r\n                        try {\r\n                            fullname = response.getString(\"fullname\");\r\n                            phone = response.getString(\"userphone\");\r\n                            identity = response.getString(\"identity\");\r\n                            myphone.setText(phone);\r\n                            mEnteredName.setText(fullname);\r\n                            img = response.getString(\"image\");\r\n                        } catch (JSONException e) {\r\n                            e.printStackTrace();\r\n                            Toast.makeText(Page8Activity.this, e.toString(), Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    }\r\n                },\r\n                new Response.ErrorListener() {\r\n                    @Override\r\n                    public void onErrorResponse(VolleyError error) {\r\n                        Toast.makeText(Page8Activity.this, error.toString(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }\r\n        );\r\n        requestQueue.add(jsonObjectRequest);\r\n    }\r\n    //儲存頭貼\r\n    private void savepic(){\r\n        String URL =Urls.url1+\"/LoginRegister/upload.php?email=\"+getmail;\r\n        StringRequest request = new StringRequest(Request.Method.POST, URL, new Response.Listener<String>() {\r\n            @Override\r\n            public void onResponse(String response) {\r\n                Toast.makeText(Page8Activity.this,response,Toast.LENGTH_SHORT).show();\r\n            }\r\n        }, new Response.ErrorListener() {\r\n            @Override\r\n            public void onErrorResponse(VolleyError error) {\r\n                Toast.makeText(Page8Activity.this,error.getMessage(),Toast.LENGTH_SHORT).show();\r\n            }\r\n        }){\r\n            @Override\r\n            protected Map<String, String> getParams() throws AuthFailureError {\r\n                Map<String,String> params = new HashMap<>();\r\n                params.put(\"image\",encodeimage);\r\n                return params;\r\n            }\r\n        };\r\n        RequestQueue requestQueue = Volley.newRequestQueue(Page8Activity.this);\r\n        requestQueue.add(request);\r\n    }\r\n    public  void fetchimage(){\r\n        String URL =Urls.url1+\"/LoginRegister/fetchimage.php?email=\"+getmail;\r\n        StringRequest request = new StringRequest(Request.Method.GET, URL, new Response.Listener<String>() {\r\n            @Override\r\n            public void onResponse(String response) {\r\n                try {\r\n                    JSONObject jsonObject = new JSONObject(response);\r\n                    img  = jsonObject.getString(\"image\");\r\n\r\n                    ImageRetriveWithPicasso();\r\n                } catch (JSONException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n        }, new Response.ErrorListener() {\r\n            @Override\r\n            public void onErrorResponse(VolleyError error) {\r\n                Toast.makeText(Page8Activity.this,error.getMessage(),Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n        RequestQueue requestQueue = Volley.newRequestQueue(Page8Activity.this);\r\n        requestQueue.add(request);\r\n    }\r\n    public void ImageRetriveWithPicasso() {\r\n        String imgurl = Urls.url1+\"/LoginRegister/images/\"+img;\r\n        Picasso.with(this)\r\n\r\n                .load(imgurl)\r\n                .placeholder(R.drawable.profile)\r\n                .fit()\r\n               // .error(R.drawable.ic_error_black_24dp)\r\n                .into(mPforfilepic, new Callback() {\r\n                    @Override\r\n                    public void onSuccess() {\r\n                        // 圖片讀取完成\r\n                        Toast.makeText(Page8Activity.this, \"Success\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n\r\n                    @Override\r\n                    public void onError() {\r\n                        // 圖片讀取失敗\r\n                      //  Toast.makeText(Page8Activity.this, \"失敗拉幹\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n        System.out.println(imgurl);\r\n    }\r\n\r\n\r\n    public String mail(){\r\n        Bundle extras = getIntent().getExtras();\r\n        if (extras!=null){\r\n            email=extras.getString(\"email\");\r\n        }\r\n        return email;\r\n    }\r\n    public String pass(){\r\n        Bundle extras = getIntent().getExtras();\r\n        if (extras!=null){\r\n            password=extras.getString(\"password\");\r\n        }\r\n        return password;\r\n    }\r\n    private View.OnClickListener itemsOnClick=new View.OnClickListener(){\r\n        @Override\r\n        public void onClick(View v) {\r\n            menuWindow.dismiss();\r\n            switch (v.getId()){\r\n                //拍照\r\n                case R.id.takePhotoBtn:\r\n                    takePhoto();\r\n                    break;\r\n                //相簿選擇相片\r\n                case R.id.SelectPhotoBtn:\r\n                    openAlbum();\r\n                    break;\r\n                case R.id.cancelBtn:\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n\r\n    private void openAlbum() {\r\n        Intent in=new Intent();\r\n        in.setType(\"image/*\");\r\n        in.setAction(Intent.ACTION_GET_CONTENT);\r\n        startActivityForResult(in,SELECT_PHOTO);\r\n    }\r\n\r\n    public void takePhoto() {\r\n        //時間命名圖片的名稱\r\n        SimpleDateFormat format = new SimpleDateFormat(\"yyyyMMddHHmmss\");\r\n        Date date = new Date(System.currentTimeMillis());\r\n        String filename = format.format(date);\r\n\r\n        //儲存至DCIM資料夾\r\n        File path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM);\r\n        File outputImage = new File(path,filename+\".jpg\");\r\n\r\n        //照片更換\r\n        try {\r\n            //如果上次的照片存在,就刪除\r\n            if (outputImage.exists()) {\r\n                outputImage.delete();\r\n            }\r\n            //創一個新文件\r\n            outputImage.createNewFile();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n        //如果Android版本大於7.0\r\n        if (Build.VERSION.SDK_INT >= 24) {\r\n            imageUri = FileProvider.getUriForFile(Page8Activity.this, \"com.example.EasyBus.fileprovider\",outputImage);\r\n        }else{\r\n            imageUri = Uri.fromFile(outputImage);\r\n        }\r\n\r\n        //申請動態權限\r\n        if(ContextCompat.checkSelfPermission(mContext, Manifest.permission.CAMERA)!= PackageManager.PERMISSION_GRANTED){\r\n            ActivityCompat.requestPermissions((Activity)mContext,new String[]{Manifest.permission.CAMERA},100);\r\n        }else{\r\n            //啟動相機程序\r\n            startCamera();\r\n        }\r\n    }\r\n\r\n    private void startCamera(){\r\n        //指定圖片輸出地址為imageUri\r\n        Intent intent=new Intent(\"android.media.action.IMAGE_CAPTURE\"); //照相\r\n        intent.putExtra(MediaStore.EXTRA_OUTPUT,imageUri); //指定圖片地址\r\n        startActivityForResult(intent,TAKE_PHOTO); //啟動相機\r\n        //拍完照startActivityForResult() 结果返回onActivityResult()函数\r\n    }\r\n\r\n    // 使用startActivityForResult()方法開啟Intent的回調\r\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data){\r\n        switch(requestCode){\r\n            case TAKE_PHOTO:\r\n                try{\r\n                    //將圖片解析成bitmap對象\r\n                    Bitmap bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(imageUri));\r\n                    //將圖片顯示出來\r\n                    mPforfilepic.setImageBitmap(bitmap);\r\n                    if(data!=null){\r\n                        System.out.println(\"turi\"+imageUri);\r\n                        System.out.println(\"tbitmap\"+bitmap.toString());\r\n                        pic=imageUri.toString();\r\n                        imageStore(bitmap);\r\n                        savepic();\r\n                    }else{\r\n\r\n                        Intent it4 = new Intent(Page8Activity.this, Page8Activity.class);\r\n                        it4.putExtra(\"email\",getmail);\r\n                        readUser();\r\n                        fetchimage();\r\n                        ImageRetriveWithPicasso();\r\n                        startActivity(it4);\r\n                    }\r\n\r\n                }catch(FileNotFoundException e){\r\n                    e.printStackTrace();\r\n                }\r\n                break;\r\n\r\n            case SELECT_PHOTO:\r\n                try {\r\n                    //獲取圖片\r\n                    if(data != null){\r\n                        Uri uri=data.getData();\r\n                    if(uri != null){\r\n                        ContentResolver cr = this.getContentResolver();\r\n                        Bitmap bitmap = BitmapFactory.decodeStream(cr.openInputStream(uri));\r\n                        mPforfilepic.setImageBitmap(bitmap);\r\n                        imageStore(bitmap);\r\n                        System.out.println(\"suri\"+uri);\r\n                        System.out.println(\"sbitmap\"+bitmap.toString());\r\n                        pic=uri.toString();\r\n                        savepic();\r\n                    }\r\n                    }else{\r\n                        Intent it4 = new Intent(Page8Activity.this, Page8Activity.class);\r\n                        it4.putExtra(\"email\",getmail);\r\n                        readUser();\r\n                        fetchimage();\r\n                        ImageRetriveWithPicasso();\r\n                        startActivity(it4);\r\n                    }\r\n\r\n                } catch (FileNotFoundException e) {\r\n\r\n                    e.printStackTrace();\r\n\r\n                }\r\n                super.onActivityResult(requestCode, resultCode, data);\r\n                break;\r\n\r\n            default:\r\n                break;\r\n\r\n        }\r\n    }\r\n\r\n    private void imageStore(Bitmap bitmap) {\r\n        ByteArrayOutputStream stream = new ByteArrayOutputStream();\r\n        bitmap.compress(Bitmap.CompressFormat.JPEG,100,stream);\r\n        byte[] imageBytes = stream.toByteArray();\r\n        encodeimage = android.util.Base64.encodeToString(imageBytes, Base64.DEFAULT);\r\n    }\r\n\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/easybus/Page8Activity.java	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/java/com/example/easybus/Page8Activity.java	(date 1632905980724)
@@ -80,7 +80,9 @@
         //隱藏title bar
         ActionBar actionBar = getSupportActionBar();
         actionBar.hide();
-
+        //抓email
+        SharedPreferences email = getSharedPreferences("email",MODE_PRIVATE);
+        getmail=email.getString("Email","");
         backBtn=findViewById(R.id.backicon);
         mEnteredName = findViewById(R.id.EnteredName);
         mPforfilepic = findViewById(R.id.profilepic);
@@ -93,7 +95,7 @@
         mContext = Page8Activity.this;
 
         requestQueue = Volley.newRequestQueue(this);
-        getmail=mail();
+
         getpass=pass();
         readUser();
         fetchimage();
@@ -103,7 +105,7 @@
             @Override
             public void onClick(View v) {
                 Intent intent = new Intent(Page8Activity.this,my_contact.class);
-                intent.putExtra("email",getmail);
+                //intent.putExtra("email",getmail);
                 startActivity(intent);
                 finish();
             }
@@ -113,7 +115,7 @@
             @Override
             public void onClick(View v) {
                 Intent intent = new Intent(Page8Activity.this,emergency_contact.class);
-                intent.putExtra("email",getmail);
+                //intent.putExtra("email",getmail);
                 startActivity(intent);
                 finish();
             }
@@ -145,7 +147,7 @@
             @Override
             public void onClick(View v) {
                 Intent intent = new Intent(Page8Activity.this,edit_password.class);
-                intent.putExtra("email",getmail);
+                //intent.putExtra("email",getmail);
                 intent.putExtra("password",getpass);
                 startActivity(intent);
                 finish();
@@ -158,11 +160,11 @@
             public void onClick(View v) {
                 if("requester".equalsIgnoreCase(identity)) {
                     Intent it4 = new Intent(Page8Activity.this, Page3Activity.class);
-                    it4.putExtra("email", getmail);
+                    //it4.putExtra("email", getmail);
                     startActivity(it4);
                 }else if("caregiver".equalsIgnoreCase(identity)){
                     Intent it = new Intent(Page8Activity.this,Page4Activity.class);
-                    it.putExtra("email",getmail);
+                    // it.putExtra("email",getmail);
                     startActivity(it);
                 }
 
@@ -265,7 +267,7 @@
                 .load(imgurl)
                 .placeholder(R.drawable.profile)
                 .fit()
-               // .error(R.drawable.ic_error_black_24dp)
+                // .error(R.drawable.ic_error_black_24dp)
                 .into(mPforfilepic, new Callback() {
                     @Override
                     public void onSuccess() {
@@ -276,20 +278,20 @@
                     @Override
                     public void onError() {
                         // 圖片讀取失敗
-                      //  Toast.makeText(Page8Activity.this, "失敗拉幹", Toast.LENGTH_SHORT).show();
+                        //  Toast.makeText(Page8Activity.this, "失敗拉幹", Toast.LENGTH_SHORT).show();
                     }
                 });
         System.out.println(imgurl);
     }
 
 
-    public String mail(){
-        Bundle extras = getIntent().getExtras();
-        if (extras!=null){
-            email=extras.getString("email");
-        }
-        return email;
-    }
+    /* public String mail(){
+         Bundle extras = getIntent().getExtras();
+         if (extras!=null){
+             email=extras.getString("email");
+         }
+         return email;
+     }*/
     public String pass(){
         Bundle extras = getIntent().getExtras();
         if (extras!=null){
@@ -406,19 +408,19 @@
                     //獲取圖片
                     if(data != null){
                         Uri uri=data.getData();
-                    if(uri != null){
-                        ContentResolver cr = this.getContentResolver();
-                        Bitmap bitmap = BitmapFactory.decodeStream(cr.openInputStream(uri));
-                        mPforfilepic.setImageBitmap(bitmap);
-                        imageStore(bitmap);
-                        System.out.println("suri"+uri);
-                        System.out.println("sbitmap"+bitmap.toString());
-                        pic=uri.toString();
-                        savepic();
-                    }
+                        if(uri != null){
+                            ContentResolver cr = this.getContentResolver();
+                            Bitmap bitmap = BitmapFactory.decodeStream(cr.openInputStream(uri));
+                            mPforfilepic.setImageBitmap(bitmap);
+                            imageStore(bitmap);
+                            System.out.println("suri"+uri);
+                            System.out.println("sbitmap"+bitmap.toString());
+                            pic=uri.toString();
+                            savepic();
+                        }
                     }else{
                         Intent it4 = new Intent(Page8Activity.this, Page8Activity.class);
-                        it4.putExtra("email",getmail);
+                        //it4.putExtra("email",getmail);
                         readUser();
                         fetchimage();
                         ImageRetriveWithPicasso();
Index: app/src/main/java/com/example/easybus/Urls.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easybus;\r\nimport java.net.InetAddress;\r\nimport java.net.UnknownHostException;\r\n\r\npublic class Urls {\r\n    //private static InetAddress ip;/////\r\n    public static String url1 = \"http://192.168.0.127\";\r\n    //public static String url1 = \"http://8c708b26959c.ngrok.io\";\r\n    public static void main(String args[]) {\r\n\r\n        /*try {\r\n            ip = InetAddress.getLocalHost();\r\n            System.out.println(ip.getHostAddress());\r\n        } catch (UnknownHostException e) {\r\n            e.printStackTrace();\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }*/\r\n\r\n\r\n\r\n    }\r\n    //static String ROOT_URL = url1+url2+url3;\r\n    //static String FORGOT_PASSWORD_URL = \"http://192.168.27.107/LoginRegister/\" + \"forgot.php\";\r\n//搞不清楚 你不是說要用appple 對阿 可是不能merge 現在又說EasyBus 有問題\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/easybus/Urls.java	(revision 2a946b5b67c0a3ebda27bf4df71d1a8955bc1111)
+++ app/src/main/java/com/example/easybus/Urls.java	(date 1632904364775)
@@ -3,8 +3,8 @@
 import java.net.UnknownHostException;
 
 public class Urls {
-    //private static InetAddress ip;/////
-    public static String url1 = "http://192.168.0.127";
+    //private static InetAddress ip;
+    public static String url1 = "http://192.168.137.1";
     //public static String url1 = "http://8c708b26959c.ngrok.io";
     public static void main(String args[]) {
 
diff --git .idea/shelf/Uncommitted_changes_before_Checkout_at_2021_7_28__04_14__Default_Changelist_.xml .idea/shelf/Uncommitted_changes_before_Checkout_at_2021_7_28__04_14__Default_Changelist_.xml
